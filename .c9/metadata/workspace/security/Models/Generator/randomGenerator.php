{"changed":true,"filter":false,"title":"randomGenerator.php","tooltip":"/security/Models/Generator/randomGenerator.php","value":"<?php\n\nclass ran\nfunction devurandom_rand($min = 0, $max = 0x7FFFFFFF) {\n    $diff = $max - $min;\n    if ($diff < 0 || $diff > 0x7FFFFFFF) {\n\t    throw new RuntimeException(\"Bad range\");\n    }\n    $bytes = mcrypt_create_iv(4, MCRYPT_DEV_URANDOM);\n    if ($bytes === false || strlen($bytes) != 4) {\n        throw new RuntimeException(\"Unable to get 4 bytes\");\n    }\n    $ary = unpack(\"Nint\", $bytes);\n    $val = $ary['int'] & 0x7FFFFFFF;   // 32-bit safe\n    $fp = (float) $val / 2147483647.0; // convert to [0,1]\n    return round($fp * $diff) + $min;\n}\n","undoManager":{"mark":-1,"position":28,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":14,"column":0},"action":"insert","lines":["function devurandom_rand($min = 0, $max = 0x7FFFFFFF) {","    $diff = $max - $min;","    if ($diff < 0 || $diff > 0x7FFFFFFF) {","\t    throw new RuntimeException(\"Bad range\");","    }","    $bytes = mcrypt_create_iv(4, MCRYPT_DEV_URANDOM);","    if ($bytes === false || strlen($bytes) != 4) {","        throw new RuntimeException(\"Unable to get 4 bytes\");","    }","    $ary = unpack(\"Nint\", $bytes);","    $val = $ary['int'] & 0x7FFFFFFF;   // 32-bit safe","    $fp = (float) $val / 2147483647.0; // convert to [0,1]","    return round($fp * $diff) + $min;","}",""]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":0,"column":1},"action":"insert","lines":["<"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":1},"end":{"row":0,"column":2},"action":"insert","lines":["?"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":2},"end":{"row":0,"column":3},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":3},"end":{"row":0,"column":4},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":4},"end":{"row":0,"column":5},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":2},"end":{"row":0,"column":5},"action":"remove","lines":["php"]},{"start":{"row":0,"column":2},"end":{"row":0,"column":5},"action":"insert","lines":["php"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":5},"end":{"row":1,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":0},"end":{"row":2,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":0},"end":{"row":2,"column":1},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":1},"end":{"row":2,"column":2},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":3},"end":{"row":2,"column":4},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":4},"end":{"row":2,"column":5},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":4},"end":{"row":2,"column":5},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":3},"end":{"row":2,"column":4},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"remove","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":1},"end":{"row":2,"column":2},"action":"remove","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":0},"end":{"row":2,"column":1},"action":"remove","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":0},"end":{"row":2,"column":1},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":1},"end":{"row":2,"column":2},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":2},"end":{"row":2,"column":3},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":3},"end":{"row":2,"column":4},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":4},"end":{"row":2,"column":5},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":5},"end":{"row":2,"column":6},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":6},"end":{"row":2,"column":7},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":7},"end":{"row":2,"column":8},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":8},"end":{"row":2,"column":9},"action":"insert","lines":["n"]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":2,"column":9},"end":{"row":2,"column":9},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1417887733521}