{"filter":false,"title":"SessionDestroy.php","tooltip":"/security/Models/Customers/SessionDestroy.php","undoManager":{"mark":20,"position":20,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":63,"column":1},"action":"insert","lines":["<?php","","namespace security\\Models\\Customers;","","use \\PDO;","use \\security\\Models\\ErrorRunner;","","class RemoveOrder ","{","    private $errors = [];","    private $orderID;","    private $customerID;","    private $pdo;","    private $errorRunner;","    private $data;","    ","    public function __construct($customerID, $orderID, PDO $pdo, ErrorRunner $errorRunner)","    {","        $this->customerID = $customerID;","        $this->orderID = $orderID;","        $this->pdo = $pdo;","        $this->errorRunner = $errorRunner;","    }","    public function removeOrder()","    {","        $errors = $this->errors;","        $pdo = $this->pdo;","        $customerID = $this->customerID;","        $orderID = $this->orderID;","        $query = \"DELETE FROM orders WHERE customers_id = :customerid AND id = :orderid\";","        $stmt = $pdo->prepare($query);","        if (!$stmt) {","            $errors[] = \"Unable to delete this record.\";","        }","        $stmt->bindParam(':customerid', $customerID, PDO::PARAM_INT);","        $stmt->bindParam(':orderid', $orderID, PDO::PARAM_INT);","        $success = $stmt->execute();","        $errorInfo = $stmt->errorInfo();","        if (isset($errorInfo[2])) {","            $errors[] = $errorInfo[2];","        }","        ","        if (!$success) {","            $errors[] = \"Unable to delete this record.\";","        }","        if ($success) {","            $deletedNumber = $stmt->rowCount();","            if (!$deletedNumber) {","                $errors[] = \"No rows were updated.\";","            }","            if ($deletedNumber) {","                $this->data = [","                    \"id\"=>$orderID,","                    \"numberRemoved\"=>\"Removed the following number of orders: $deletedNumber\"","                ];","                ","                return $this->data;","            }","        }","        if (!empty($errors)) {","            $this->errorRunner->runErrors($errors);","        }","    }","}"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":6},"end":{"row":7,"column":17},"action":"remove","lines":["RemoveOrder"]},{"start":{"row":7,"column":6},"end":{"row":7,"column":7},"action":"insert","lines":["D"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":7},"end":{"row":7,"column":8},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":8},"end":{"row":7,"column":9},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":9},"end":{"row":7,"column":10},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":10},"end":{"row":7,"column":11},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":6},"end":{"row":7,"column":11},"action":"remove","lines":["Destr"]},{"start":{"row":7,"column":6},"end":{"row":7,"column":20},"action":"insert","lines":["DestroySession"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":6},"end":{"row":7,"column":20},"action":"remove","lines":["DestroySession"]},{"start":{"row":7,"column":6},"end":{"row":7,"column":7},"action":"insert","lines":["S"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":7},"end":{"row":7,"column":8},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":8},"end":{"row":7,"column":9},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":9},"end":{"row":7,"column":10},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":10},"end":{"row":7,"column":11},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":11},"end":{"row":7,"column":12},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":12},"end":{"row":7,"column":13},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":13},"end":{"row":7,"column":14},"action":"insert","lines":["D"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":14},"end":{"row":7,"column":15},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":15},"end":{"row":7,"column":16},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":16},"end":{"row":7,"column":17},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":17},"end":{"row":7,"column":18},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":18},"end":{"row":7,"column":19},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":19},"end":{"row":7,"column":20},"action":"insert","lines":["y"]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":7,"column":20},"end":{"row":7,"column":20},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1421525730296,"hash":"9531d6e998f6299c3c7b0d251e72716006f8c43e"}