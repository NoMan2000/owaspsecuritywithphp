{"changed":true,"filter":false,"title":"PasswordVulnerable.php","tooltip":"/security/Models/Customers/PasswordVulnerable.php","value":"<?php\n\nnamespace security\\Models\\Login;\n\nrequire_once(dirname(dirname(dirname(__DIR__))) . '/vendor/autoload.php');\n\nclass PasswordVulnerable \n{\n    private $textFile = 'badpasswordlist/passwords.txt';\n    private $arrayFile = 'badpasswordlist/passwords.php';\n    private $passwords;\n    private $password;\n\n    public function __construct($password, $update = false) \n    {\n        $this->password = $password;\n        if (!file_exists($this->arrayFile) || $update) {\n            touch($this->arrayFile);\n            $arrayFull = '<?php \n                return [';\n            $badpasswords = file($this->textFile, FILE_IGNORE_NEW_LINES);\n            $len = count($badpasswords);\n            $lenMinus = $len - 1;\n            for($i = 0; $i < $len; $i++) {\n                if ($i !== $lenMinus) {\n                    $arrayFull .= \"'{$badpasswords[$i]}',\";\n                }\n                if ($i === $lenMinus) {\n                    $arrayFull .= \"'{$badpasswords[$i]}'\";\n                }\n            }\n            $arrayFull .= '];';\n            file_put_contents($this->arrayFile, $arrayFull);\n        }\n        $this->passwords = require_once($this->arrayFile);\n        $this->isVulnerable($password);\n    }\n    public function isVulnerable()\n    {\n        if (in_array($this->password, $this->passwords)) {\n            return true;\n        }\n        return false;\n    }\n}","undoManager":{"mark":15,"position":5,"stack":[[{"group":"doc","deltas":[{"start":{"row":2,"column":19},"end":{"row":2,"column":30},"action":"remove","lines":["Controllers"]},{"start":{"row":2,"column":19},"end":{"row":2,"column":20},"action":"insert","lines":["M"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":20},"end":{"row":2,"column":21},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":21},"end":{"row":2,"column":22},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":22},"end":{"row":2,"column":23},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":23},"end":{"row":2,"column":24},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":24},"end":{"row":2,"column":25},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":26},"end":{"row":2,"column":27},"action":"insert","lines":["C"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":27},"end":{"row":2,"column":28},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":28},"end":{"row":2,"column":29},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":29},"end":{"row":2,"column":30},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":30},"end":{"row":2,"column":31},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":31},"end":{"row":2,"column":32},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":32},"end":{"row":2,"column":33},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":33},"end":{"row":2,"column":34},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":34},"end":{"row":2,"column":35},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":35},"end":{"row":2,"column":36},"action":"insert","lines":["\\"]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":2,"column":26},"end":{"row":2,"column":26},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1420930393541}